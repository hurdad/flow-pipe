namespace:
  create: true
  name: flow-pipe

# --------------------------------------------------
# OpenTelemetry
# --------------------------------------------------
observability:
  enabled: false
  exporterOtlpGrpcEndpoint: "localhost:4317"

# --------------------------------------------------
# Alerting (PrometheusRule)
# --------------------------------------------------
alerting:
  enabled: false
  api:
    errorRateThreshold: 0.05
    minRequestCount: 20
    latencyP95Ms: 500
  controller:
    maxQueueDepth: 100
    failureCount: 1
  runtime:
    queueDwellP95Ms: 5000
    stageErrorCount: 1

# --------------------------------------------------
# Etcd (used by API + controller)
# --------------------------------------------------
etcd:
  enabled: true
  image: quay.io/coreos/etcd:v3.5.15
  imagePullPolicy: IfNotPresent
  replicas: 1
  port: 2379
  ha:
    enabled: false
  monitor:
    enabled: false
    interval: 30s
    scrapeTimeout: 10s
    labels: {}
  service:
    # Options: ClusterIP (default), LoadBalancer
    type: ClusterIP
  storage:
    size: 5Gi
    storageClassName: ""
  # Computed into ETCD_ENDPOINTS
  endpoints:
    - http://flow-pipe-etcd:2379

# --------------------------------------------------
# Controller
# --------------------------------------------------
controller:
  image: ghcr.io/hurdad/flow-pipe-controller:main
  imagePullPolicy: IfNotPresent
  replicas: 1
  workerCount: 1
  serviceName: flow-controller
  logLevel: info
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 256Mi

# --------------------------------------------------
# API
# --------------------------------------------------
api:
  enabled: true
  image: ghcr.io/hurdad/flow-pipe-api:main
  imagePullPolicy: IfNotPresent
  replicas: 1
  serviceName: flow-api
  logLevel: info
  auth:
    enabled: false
    # When true, create a Secret containing the API key.
    createSecret: false
    # Secret name to reference for FLOW_API_KEY.
    secretName: flow-pipe-api-auth
    # Secret key holding the API key string.
    secretKey: api-key
    # API key value used when createSecret is true.
    apiKey: ""
  tls:
    enabled: false
    # Secret name holding TLS cert/key for the HTTP server.
    secretName: flow-pipe-api-tls
    # Secret keys containing the certificate and private key.
    certKey: tls.crt
    keyKey: tls.key
    # Mount path for TLS material inside the API container.
    mountPath: /etc/flow-pipe/tls
    # Expected server name for gRPC TLS clients.
    serverName: flow-pipe-api

  httpService:
    # Options: ClusterIP (default), LoadBalancer
    type: ClusterIP

  # These map directly to env vars
  grpcAddr: ":9090"
  httpAddr: ":8080"

  # Used only for container/service ports
  grpcPort: 9090
  httpPort: 8080

  grpcService:
    enabled: false
    # Options: ClusterIP, LoadBalancer
    type: ClusterIP
    annotations: {}

  ingress:
    enabled: false
    host: flow-pipe.local
    annotations: {}
    # Optional: specify the ingressClass.
    className: ""
    # Optional: override the path used by the ingress rule.
    path: "/"
    tls:
      enabled: false
      secretName: ""

# --------------------------------------------------
# Runtime
# --------------------------------------------------
runtime:
  serviceName: flow-runtime
